"use strict";(self["webpackChunksnack_party"]=self["webpackChunksnack_party"]||[]).push([[615],{1793:function(t,e,o){o.r(e),o.d(e,{default:function(){return N}});var r=o(6768);const a={class:"container"},l=(0,r.Lk)("div",{class:"container-xxl flex-grow-1 container-p-y"},[(0,r.Lk)("div",{class:"card"},[(0,r.Lk)("h3",null,"주문조회")])],-1);function d(t,e,o,d,i,n){const s=(0,r.g2)("AdminOrderDetailComp");return(0,r.uX)(),(0,r.CE)("div",a,[l,(0,r.bF)(s,{order_code:i.order_code,member_code:i.member_code},null,8,["order_code","member_code"])])}var i=o(4232),n=o(5130);const s=t=>((0,r.Qi)("data-v-43e64a6e"),t=t(),(0,r.jt)(),t),c={class:"container-xxl flex-grow-1 container-p-y"},u={class:"card"},h={class:"table-responsive"},p={class:"table"},L=s((()=>(0,r.Lk)("th",null,"주문코드",-1))),m=s((()=>(0,r.Lk)("th",null,"회원코드",-1))),_=s((()=>(0,r.Lk)("th",null,"주문일자",-1))),k=s((()=>(0,r.Lk)("th",null,"상품금액",-1))),v=s((()=>(0,r.Lk)("th",null,"배송비",-1))),g=s((()=>(0,r.Lk)("th",null,"적립금 사용",-1))),y=s((()=>(0,r.Lk)("th",null,"총결제금액",-1))),f=s((()=>(0,r.Lk)("th",null,"적립금",-1))),b=s((()=>(0,r.Lk)("th",null,"주문상태",-1))),$={class:"input-group w-300"},C=(0,r.Fv)('<option value="" data-v-43e64a6e>전체 카테고리</option><option value="h01" data-v-43e64a6e>결제완료</option><option value="h02" data-v-43e64a6e>주문취소</option><option value="h03" data-v-43e64a6e>배송준비중</option><option value="h04" data-v-43e64a6e>배송중</option><option value="h05" data-v-43e64a6e>배송완료</option><option value="h06" data-v-43e64a6e>반품취소</option><option value="h07" data-v-43e64a6e>반품완료</option><option value="h08" data-v-43e64a6e>환불완료</option>',9),w=[C],A=s((()=>(0,r.Lk)("th",null,"운송장번호",-1))),F={class:"table-responsive",style:{"text-align":"center"}},x={class:"table"},O=s((()=>(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",{scope:"col"},"이미지"),(0,r.Lk)("th",{scope:"col"},"상품명"),(0,r.Lk)("th",{scope:"col"},"상품가격"),(0,r.Lk)("th",{scope:"col"},"수량"),(0,r.Lk)("th",{scope:"col"},"총 가격")])],-1))),D={scope:"row"},I={class:"d-flex align-items-center mt-2"},U=["src"],S={class:"py-5"},E={class:"py-5"},P={class:"py-5"},R={class:"py-5"};function X(t,e,o,a,l,d){return(0,r.uX)(),(0,r.CE)("div",c,[(0,r.Lk)("div",u,[(0,r.Lk)("div",h,[(0,r.Lk)("table",p,[(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[L,(0,r.Lk)("td",null,(0,i.v_)(this.orderList.merchant_uid),1)]),(0,r.Lk)("tr",null,[m,(0,r.Lk)("td",null,(0,i.v_)(this.orderList.member_code),1)]),(0,r.Lk)("tr",null,[_,(0,r.Lk)("td",null,(0,i.v_)(t.$formatDate(this.orderList.order_date)),1)]),(0,r.Lk)("tr",null,[k,(0,r.Lk)("td",null,(0,i.v_)(t.$currencyFormat(this.orderList.order_price))+"원",1)]),(0,r.Lk)("tr",null,[v,(0,r.Lk)("td",null,(0,i.v_)(t.$currencyFormat(this.orderList.delivery_fee))+"원",1)]),(0,r.Lk)("tr",null,[g,(0,r.Lk)("td",null,(0,i.v_)(t.$currencyFormat(this.orderList.use_point))+"원",1)]),(0,r.Lk)("tr",null,[y,(0,r.Lk)("td",null,(0,i.v_)(t.$currencyFormat(this.orderList.total_price))+"원",1)]),(0,r.Lk)("tr",null,[f,(0,r.Lk)("td",null,(0,i.v_)(t.$currencyFormat(this.orderList.get_point))+"원",1)]),(0,r.Lk)("tr",null,[b,(0,r.Lk)("td",null,[(0,r.Lk)("div",$,[(0,r.bo)((0,r.Lk)("select",{id:"ProductCategory",class:"form-select text-capitalize w-150","onUpdate:modelValue":e[0]||(e[0]=t=>l.order_status=t)},w,512),[[n.u1,l.order_status]])])])]),(0,r.Lk)("tr",null,[A,(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>l.orderList.delivery_num=t)},null,512),[[n.Jo,l.orderList.delivery_num]])])])])])]),(0,r.Lk)("div",F,[(0,r.Lk)("table",x,[O,(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.detailList,((e,o)=>((0,r.uX)(),(0,r.CE)("tr",{key:o},[(0,r.Lk)("th",D,[(0,r.Lk)("div",I,[(0,r.Lk)("img",{src:d.getImgUrl(l.detailList[o].path),width:"100px",class:"img-fluid rounded-top",alt:""},null,8,U)])]),(0,r.Lk)("td",S,(0,i.v_)(e.product_name),1),(0,r.Lk)("td",E,(0,i.v_)(t.$currencyFormat(e.product_price))+"원",1),(0,r.Lk)("td",P,(0,i.v_)(e.cart_cnt)+"개",1),(0,r.Lk)("td",R,(0,i.v_)(t.$currencyFormat(e.product_price*e.cart_cnt))+"원",1)])))),128))])]),(0,r.Lk)("button",{type:"button",class:"form-control",onClick:e[2]||(e[2]=(...t)=>d.changeStatus&&d.changeStatus(...t))},"수정"),(0,r.Lk)("button",{type:"button",class:"form-control",onClick:e[3]||(e[3]=e=>t.$router.go(-1))},"취소")])])])}o(4114),o(4603),o(7566),o(8721);var M=o(8355),q={name:"AdminOrderDetailComp",props:["order_code","merchant_uid","member_code"],data(){return{oCode:this.order_code,mCode:this.member_code,mUid:this.merchant_uid,orderList:[],detailList:[],order_status:""}},created(){this.getOrderInfo(),this.getMyOrdDetail(),this.validation()},methods:{ordStatus(t){return"h01"==t?"결제완료":"h02"==t?"주문취소":"h03"==t?"배송준비중":"h04"==t?"배송중":"h05"==t?"배송완료":"h06"==t?"반품취소":"h07"==t?"반품완료":"환불완료"},async changeStatus(){let t=0;if("h05"==this.order_status){let e=await M.A.get(`/api/admin/checkPoint/${this.oCode}`).catch((t=>console.log(t)));t=e.data[0].count}if("h04"==this.order_status&&!this.validation(this.orderList.delivery_num))return void alert("올바른 운송장 정보를 입력해주세요");let e=await M.A.put(`/api/admin/updateOrderStatus/${this.order_status}/${this.oCode}`).catch((t=>console.log(t))),o=e.data.affectedRows;if(o>0){if(alert("주문상태가 수정되었습니다."),"h05"==this.order_status)if(t>0)alert("이미 해당 주문에 적립된 적립금이 있습니다.");else{let t=await M.A.post(`/api/admin/addPoint/${this.oCode}/${this.mCode}`).catch((t=>console.log(t))),e=t.data.affectedRows,o=await M.A.put(`/api/admin/updateOrderPoint/${this.oCode}`).catch((t=>console.log(t))),r=o.data.changedRows;e>0&&r>0&&alert("배송이 완료되어 적립금이 적립되었습니다.")}null!=this.orderList.delivery_num&&(console.log(`this.orderList.delivery_num : ${this.orderList.delivery_num}, this.oCode : ${this.oCode}`),await M.A.put(`/api/admin/updateDeliveryNum/${this.orderList.delivery_num}/${this.oCode}`).catch((t=>console.log(t))))}this.$router.go(0)},async getOrderInfo(){let t=await M.A.get(`/api/admin/orderInfo/${this.oCode}`).catch((t=>console.log(t)));this.orderList=t.data[0],this.order_status=this.orderList.order_status,console.log(this.orderList)},async getMyOrdDetail(){let t=await M.A.get(`/api/order/myord/details/${this.oCode}/${this.mCode}`).catch((t=>console.log(t)));console.log("getMyOrdDetail() : ",t),this.detailList=this.changeField(t.data),console.log(this.detailList)},changeField(t){let e=[];for(let o of t)e.push({detail_code:o.detail_code,merchant_uid:o.merchant_uid,product_price:o.product_price,cart_cnt:o.order_cnt,detail_price:o.detail_price,product_name:o.product_name,path:o.path,order_status:o.order_status});return e},getImgUrl(t){return t?new URL(this.url+"/common/download?path="+t):""},validation(t){const e=/^[0-9]{12}$/;return!!e.test(t)}}},V=o(1241);const j=(0,V.A)(q,[["render",X],["__scopeId","data-v-43e64a6e"]]);var z=j,J={name:"AdminOrderDetail",components:{AdminOrderDetailComp:z},data(){return{order_code:this.$route.query.order_code,member_code:this.$route.query.member_code}},setup(){},created(){this.print()},mounted(){},unmounted(){},methods:{print(){console.log(this.order_code,this.member_code)}}};const K=(0,V.A)(J,[["render",d]]);var N=K}}]);
//# sourceMappingURL=AdminOrderDetail.fe24958d.js.map